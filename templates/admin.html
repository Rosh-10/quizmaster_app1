{% extends "base.html" %}

{% block content %}
<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <a class="navbar-brand" href="/admin ">Quiz Master</a>
    <div class="collapse navbar-collapse" id="navbarText">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/admin">Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin_userlist">Users</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/adminSubject">Subjects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/adminChapter">Chapters</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/adminchart">Summary</a>
        </li>
        <!-- Search bar -->
        <form class="d-flex mb-3" role="search" action="/adminsearch" method="GET" >
          <input class="form-control me-2" type="search" placeholder="Search by name" aria-label="Search" name="search_query" id="search">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
        <li class="nav-item">
          <a class="nav-link" href="/admin/logout">Logout</a>
        </li>
      </ul>
    </div>
  </div>
</nav>


<div class="container">
  <h1 class="info">Admin Dashboard</h1>
  <p class="info">Welcome to the admin dashboard.<br>
    Here you can manage the users and subjects.
  </p>
  <div class="row">
    <div class="col">
      <h2>Users</h2>
      <p>Showing the first 3 users</p>
      {% set n_users = (user|length, 3)|min %}
      {% if n_users == 0 %}
        <p>No users found.</p>
      {% else %}
        {% for us in user[:n_users] %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{us.User_fullname}}</h5>
            <p class="card-text">Email: {{us.User_email}}</p>
            <a href="/adminUser/{{us.id}}" class="stretched-link"></a>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="col">
      <h2>Subjects</h2>
      <p>Showing the first 3 subjects</p>
      {% set n_subjects = (subject|length, 3)|min %}
      {% if n_subjects == 0 %}
        <p>No subjects found.</p>
      {% else %}
        {% for sub in subject[:n_subjects] %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{sub.sub_name}}</h5>
            <p class="card-text">Subject Code: {{sub.sub_code}}</p>
            <p class="card-text">Subject Description: {{sub.sub_desc}}</p>
            <a href="/adminSubject/{{sub.sub_id}}" class="stretched-link"></a>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="col">
      <h2>Chapters</h2>
      <p>Showing the first 3 chapters</p>
      {% set n_chapters = (chapter|length, 3)|min %}
      {% if n_chapters == 0 %}
        <p>No chapters found.</p>
      {% else %}
        {% for chapter in chapter[:n_chapters] %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{chapter.ch_name}}</h5>
            <p class="card-text">Chapter Code: {{chapter.ch_code}}</p>
            <p class="card-text">Chapter Description: {{chapter.ch_desc}}</p>
            <a href="/adminChapter/{{chapter.ch_id}}" class="stretched-link"></a>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="col">
      <h2>Quizzes</h2>
      <p>Showing the first 3 quizzes</p>
      {% set n_quizzes = (quizzes|length, 3)|min %}
      {% if n_quizzes == 0 %}
        <p>No quizzes found.</p>
      {% else %}
        {% for quiz in quizzes[:n_quizzes] %}
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">{{quiz.qz_name}}</h5>
            <p class="card-text">Quiz Code: {{quiz.qz_code}}</p>
            <p class="card-text">Quiz Description: {{quiz.qz_desc_remarks}}</p>
            <a href="/adminQuiz/{{quiz.qz_id}}" class="stretched-link"></a>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}

